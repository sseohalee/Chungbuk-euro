{% extends 'base.html' %}
{% block content %}

    <!-- Header -->
    <header class="ex-header">
        <div class="container">
            <div class="row">
                <div class="col-xl-10 offset-xl-1 info-header">
                    <h1>ë‚˜ì˜ ì¼ì •</h1>
                </div> <!-- end of col -->
            </div> <!-- end of row -->
        </div> <!-- end of container -->
    </header> <!-- end of ex-header -->
    <!-- end of header -->


    <div class="container rec-div">
        <div class="row">
            <div class="col-xl-10 offset-xl-1 schedule-detail">
                <h3>{{ tour.region }}</h3>
                <p>
                    {% set tour_keyword=survey.tour_keyword.split('|') %}
                    {% for keyword in tour_keyword %}
                    <span class="schedule-tag">#{{ keyword }}</span>
                    {% endfor %}<br>
                </p>
                <div id="map" style="width:100%;height:400px;">
                    <!--<img src="{{ url_for('static',filename='images/location.png') }}"> -->
                </div>
                <div class="schedule-datail-box">
                    <h5>1ï¸âƒ£ì ì‹¬</h5>
                    <span class="half_HL">{{lunch.name}}</span> <br>
                    ğŸš {{ lunch.cate }} | â­ <b>{{ lunch.star }}</b>/5 ({{ lunch.qty }})<br>
                    <button type="submit" class="schedule-btn" onclick="location.href='{{ lunch.url }}'">ë§›ì§‘ ì •ë³´</button>
                </div>
                <div class="schedule-datail-box">
                    <h5>2ï¸âƒ£ê´€ê´‘ ëª…ì†Œ</h5>
                    <span class="half_HL">{{ tour.name }}</span> <br>
                    ğŸ—¼ {{ tour.cate }} <br>
                    <div class="schedule-detail-cate">{{ tour.acc }}</div>
                </div>
                <div class="schedule-datail-box">
                    <h5>3ï¸âƒ£ì¹´í˜</h5>
                    <span class="half_HL">{{ cafe.name }}</span> <br>
                    ğŸ° {{ cafe.cate }} | â­ <b>{{ cafe.star }}</b>/5 ({{ cafe.qty }})<br>
                    <button type="submit" class="schedule-btn" onclick="location.href='{{ cafe.url }}'">ë§›ì§‘ ì •ë³´</button>
                </div>
                <div class="schedule-datail-box">
                    <h5>4ï¸âƒ£ì €ë…</h5>
                    <span class="half_HL">{{ dinner.name }}</span> <br>
                    ğŸ¸ {{ dinner.cate }} | â­ <b>{{ dinner.star }}</b>/5 ({{ dinner.qty }})<br>
                    <button type="submit" class="schedule-btn" onclick="location.href='{{ dinner.url }}'">ë§›ì§‘ ì •ë³´</button>
                </div>
                <div style="height:50px;"></div>
            </div>
        </div>
    </div>

<script>
var HOME_PATH = window.HOME_PATH || '.';

// ì§€ë„ ì¤‘ì•™
var mapOptions = {
    center: new naver.maps.LatLng({{ lunch.lat }}, {{ lunch.lng }}),
    zoom: 12
};

// ì§€ë„ ìƒì„±
var map = new naver.maps.Map('map', mapOptions);

// ë§ˆì»¤ ìƒì„±
var lunchMarker = new naver.maps.Marker({
    position: new naver.maps.LatLng({{ lunch.lat }}, {{ lunch.lng }}),
    map: map
});
var dinnerMarker = new naver.maps.Marker({
    position: new naver.maps.LatLng({{ dinner.lat }}, {{ dinner.lng }}),
    map: map
});
var cafeMarker = new naver.maps.Marker({
    position: new naver.maps.LatLng({{ cafe.lat }}, {{ cafe.lng }}),
    map: map
});

// ì •ë³´ì°½ ë‚´ìš©
var lunchString = [
        '<div class="iw_inner" style="padding-left:10px;padding-right:10px;">',
        '   <p style="font-size:10px;margin-bottom:-10px;"><ì ì‹¬></p>',
        '   <p style="font-size:12px;margin-bottom:-10px;text-align:center;"><b>{{ lunch.name }}</b></p>',
        '   <p style="font-size:10px;margin-top:-10px;margin-bottom:-8px;">ğŸš{{ lunch.cate }}',
        '   </p>',
        '</div>'
    ].join('');

var dinnerString = [
        '<div class="iw_inner" style="padding-left:10px;padding-right:10px;">',
        '   <p style="font-size:10px;margin-bottom:-10px;"><ì €ë…></p>',
        '   <p style="font-size:12px;margin-bottom:-10px;text-align:center;"><b>{{ dinner.name }}</b></p>',
        '   <p style="font-size:10px;margin-top:-10px;margin-bottom:-8px;">ğŸ¸{{ dinner.cate }}',
        '   </p>',
        '</div>'
    ].join('');

var cafeString = [
        '<div class="iw_inner" style="padding-left:10px;padding-right:10px;">',
        '   <p style="font-size:10px;margin-bottom:-10px;"><ì¹´í˜></p>',
        '   <p style="font-size:12px;margin-bottom:-10px;text-align:center;"><b>{{ cafe.name }}<b></p>',
        '   <p style="font-size:10px;margin-top:-10px;margin-bottom:-8px;">ğŸ°{{ cafe.cate }}',
        '   </p>',
        '</div>'
    ].join('');

// ì •ë³´ì°½ ìƒì„±
var lunchInfowindow = new naver.maps.InfoWindow({
    content: lunchString
});

var dinnerInfowindow = new naver.maps.InfoWindow({
    content: dinnerString
});

var cafeInfowindow = new naver.maps.InfoWindow({
    content: cafeString
});

// ë§ˆì»¤ í´ë¦­ì‹œ
naver.maps.Event.addListener(lunchMarker, "click", function(e) {
    if (lunchInfowindow.getMap()) {
        lunchInfowindow.close();
    } else {
        lunchInfowindow.open(map, lunchMarker);
    }
});

naver.maps.Event.addListener(dinnerMarker, "click", function(e) {
    if (dinnerInfowindow.getMap()) {
        dinnerInfowindow.close();
    } else {
        dinnerInfowindow.open(map, dinnerMarker);
    }
});

naver.maps.Event.addListener(cafeMarker, "click", function(e) {
    if (cafeInfowindow.getMap()) {
        cafeInfowindow.close();
    } else {
        cafeInfowindow.open(map, cafeMarker);
    }
});

lunchInfowindow.open(map, lunchMarker);

// í´ë¦¬ë¼ì¸
var polyline = new naver.maps.Polyline({
    map: map,
    path: [
        new naver.maps.LatLng({{ lunch.lat }}, {{ lunch.lng }}),
        new naver.maps.LatLng({{ cafe.lat }}, {{ cafe.lng }}),
        new naver.maps.LatLng({{ dinner.lat }}, {{ dinner.lng }})
    ],
    strokeColor: '#F986A6',
    strokeOpacity: 0.7,
    strokeWeight: 5
});

</script>

{% endblock %}